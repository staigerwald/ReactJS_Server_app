# Тестовое задание для DevOps

1. Подготовить Docker Compose окружение:
   Состоящее из:
   1. Reverse Proxy (Nginx)
      1. Должен поддерживать scale всех подключенных сервисов. То есть, в любой момент времени можно заскейлить сервис и он добавится проксированию без перезапусков.
      2. Для deploy-типа окружений должен присутствовать Letsencrypt компаньон, генерирующий SSL сертификаты для всех доменов окружения. 
   2. Keycloak 
      1. Для deploy-типа окружений БД должна вынесена быть в отдельный сервис и заволюмлена (Postgres)
      Находится на хосте id.{BASE_HOST?} 
   3. React JS приложение 
      1. Находится на хосте {BASE_HOST?} 
      2. Для локального окружения
         должна волюмится кодовая база 
      3. Запускаться dev режим 
      4. Перед запуском, если node_modules не установлены - установить 
      5. Для deploy-типа окружения билд должен собираться в статику и подкладываться под Nginx 
   4. Centrifugo 
      1. Находится на хосте centrifugo.{BASE_HOST?}. 
   5. Portainer 
      1. Находится на хосте portainer.{BASE_HOST?}. 
      2. Доступно только для deploy-типа окружений.

2. Окружения должны подниматься командой docker-compose --wait --detach --build, вне зависимости от текущего состояния. 
3. Секреты (пароли, ключи и т.д.) не должны хранится в кодовой базе, должны поставляться через переменные окружения. 
4. Docker Compose должен быть разбит на файлы по сервисно. Файлы сервиса должны лежать в директории соответствующего сервиса. 
5. Подготовить Gitlab CI скрипты:
   1. Тригером для запуска пайплайнов - создание тега 
   2. Теги регламентированы семантическим версионированием. 
   3. Теги beta - develop окружение 
   4. Теги rc - stage окружение 
   5. Теги stable - production окружение 
6. Подготовить ansible скрипт для базовой настройки сервера:
   1. Установлено:
      1. Docker 
      2. Docker Compose 
      3. Gitlab 
   2. RunnerЗакрыто подключение по паролю через SSH 
   3. Для пользователя gitlab-runner выдан доступ к Docker, Docker Compose
